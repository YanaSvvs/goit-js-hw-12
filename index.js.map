{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '50595103-65097a90456797714ffdbb949'; \nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nexport async function getImagesByQuery(query, page) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: PER_PAGE,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${params.toString()}`);\n    return response.data;\n  } catch (error) {\n    console.error(\"Error fetching images from Pixabay:\", error);\n    throw new Error(error.response?.data?.message || error.message || 'Failed to fetch images');\n  }\n}","const galleryElement = document.getElementById('gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreButtonElement = document.getElementById('load-more-btn');\n\nlet lightbox;\n\nexport function createGallery(images) {\n  if (!galleryElement) {\n    console.error('Gallery element not found!');\n    return;\n  }\n\n  const markup = images.map(image => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${image.webformatURL}\"\n          alt=\"${image.tags}\"\n          loading=\"lazy\"\n        />\n      </a>\n      <div class=\"info\">\n        <p><b>Likes</b> ${image.likes}</p>\n        <p><b>Views</b> ${image.views}</p>\n        <p><b>Comments</b> ${image.comments}</p>\n        <p><b>Downloads</b> ${image.downloads}</p>\n      </div>\n    </li>\n  `).join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', markup); \n\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n}\n\nexport function clearGallery() {\n  if (galleryElement) {\n    galleryElement.innerHTML = '';\n  }\n}\n\nexport function showLoader() {\n  if (loaderElement) {\n    loaderElement.classList.remove('is-hidden');\n  }\n}\n\nexport function hideLoader() {\n  if (loaderElement) {\n    loaderElement.classList.add('is-hidden');\n  }\n}\n\nexport function showLoadMoreButton() {\n  if (loadMoreButtonElement) {\n    loadMoreButtonElement.classList.remove('is-hidden');\n  }\n}\n\nexport function hideLoadMoreButton() {\n  if (loadMoreButtonElement) {\n    loadMoreButtonElement.classList.add('is-hidden');\n  }\n}","// main.js\n\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton\n} from './js/render-functions.js';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchForm = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst loadMoreBtn = document.getElementById('load-more-btn');\nconst galleryElement = document.getElementById('gallery');\n\nlet currentQuery = '';\nlet currentPage = 1;\nconst PER_PAGE = 15;\nconst LOADER_MIN_DISPLAY_TIME = 500; \n\nhideLoader();\nhideLoadMoreButton();\n\nsearchForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  const query = searchInput.value.trim();\n\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Search query cannot be empty!',\n      position: 'topRight',\n      timeout: 3000,\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  clearGallery();\n  hideLoadMoreButton();\n\n  await fetchAndRenderImages();\n  searchForm.reset();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n  await fetchAndRenderImages(true);\n});\n\nasync function fetchAndRenderImages(isLoadMore = false) {\n  showLoader(); \n  if (isLoadMore) {\n    hideLoadMoreButton(); \n  }\n\n  const startTime = Date.now(); \n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    const elapsedTime = Date.now() - startTime;\n    const remainingTime = LOADER_MIN_DISPLAY_TIME - elapsedTime;\n\n    if (remainingTime > 0) {\n      await new Promise(resolve => setTimeout(resolve, remainingTime));\n    }\n\n    if (data.hits && data.hits.length > 0) {\n      createGallery(data.hits);\n\n      if (isLoadMore) {\n        const firstNewCard = galleryElement.lastElementChild;\n        if (firstNewCard) {\n          const cardRect = firstNewCard.getBoundingClientRect();\n          if (cardRect.height > 0) {\n            window.scrollBy({\n              top: cardRect.height * 2,\n              behavior: 'smooth',\n            });\n          }\n        }\n      }\n\n      const totalLoadedImages = (currentPage - 1) * PER_PAGE + data.hits.length;\n      if (totalLoadedImages < data.totalHits) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        if (data.totalHits > 0) {\n          iziToast.info({\n            title: 'Info',\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n            timeout: 5000,\n          });\n        }\n      }\n    } else {\n      hideLoadMoreButton();\n      if (!isLoadMore && currentPage === 1) {\n        iziToast.info({\n          title: 'No Results',\n          message: 'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n          timeout: 5000,\n        });\n      } else if (data.totalHits > 0) {\n        iziToast.info({\n          title: 'Info',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          timeout: 5000,\n        });\n      }\n    }\n  } catch (error) {\n    console.error(\"Search or load more failed:\", error);\n    iziToast.error({\n      title: 'Error',\n      message: `Failed to fetch images: ${error.message || 'Unknown error'}. Please try again later.`,\n      position: 'topRight',\n      timeout: 5000,\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n  }\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","getImagesByQuery","query","page","params","axios","error","_b","_a","galleryElement","loaderElement","loadMoreButtonElement","lightbox","createGallery","images","markup","image","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","searchForm","searchInput","loadMoreBtn","currentQuery","currentPage","LOADER_MIN_DISPLAY_TIME","event","fetchAndRenderImages","isLoadMore","startTime","data","elapsedTime","remainingTime","resolve","firstNewCard","cardRect"],"mappings":"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"}